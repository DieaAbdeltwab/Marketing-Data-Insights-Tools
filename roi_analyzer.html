<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ultimate ROI Analyzer Pro 3.0</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.2), transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.15), transparent 50%),
        radial-gradient(circle at 50% 20%, rgba(139, 92, 246, 0.1), transparent 50%);
      pointer-events: none;
      z-index: 0;
      animation: bgPulse 25s ease-in-out infinite;
    }

    @keyframes bgPulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.05); }
    }

    .container {
      max-width: 1800px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .roi-header {
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95) 0%, rgba(31, 41, 55, 0.95) 100%);
      backdrop-filter: blur(30px);
      border-radius: 35px;
      padding: 60px 40px;
      text-align: center;
      box-shadow: 0 40px 100px rgba(0, 0, 0, 0.6), 0 0 80px rgba(102, 126, 234, 0.2);
      margin-bottom: 30px;
      border: 2px solid rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
    }

    .roi-header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(102, 126, 234, 0.1), transparent);
      animation: shimmer 6s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .roi-header h1 {
      background: linear-gradient(135deg, #667eea 0%, #ec4899 50%, #8b5cf6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 4em;
      margin-bottom: 15px;
      font-weight: 900;
      letter-spacing: -3px;
      position: relative;
      z-index: 1;
    }

    .roi-header .subtitle {
      color: #94a3b8;
      font-size: 1.3em;
      font-weight: 700;
      letter-spacing: 4px;
      text-transform: uppercase;
      position: relative;
      z-index: 1;
    }

    .input-section {
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95) 0%, rgba(31, 41, 55, 0.95) 100%);
      backdrop-filter: blur(30px);
      border-radius: 35px;
      padding: 45px;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5), 0 0 80px rgba(102, 126, 234, 0.15);
      margin-bottom: 30px;
      border: 2px solid rgba(102, 126, 234, 0.3);
    }

    .input-section h2 {
      color: #f1f5f9;
      margin-bottom: 35px;
      font-size: 2.2em;
      background: linear-gradient(135deg, #667eea 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 900;
      padding-bottom: 20px;
      border-bottom: 3px solid;
      border-image: linear-gradient(90deg, #667eea, #ec4899) 1;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin-bottom: 35px;
    }

    .input-group {
      display: flex;
      flex-direction: column;
    }

    .input-group label {
      font-weight: 700;
      margin-bottom: 10px;
      color: #f1f5f9;
      font-size: 0.95em;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .input-group input {
      padding: 18px 22px;
      border: 2px solid rgba(102, 126, 234, 0.3);
      border-radius: 16px;
      font-size: 1.05em;
      transition: all 0.3s ease;
      background: rgba(15, 23, 42, 0.6);
      font-weight: 600;
      color: #f1f5f9;
    }

    .input-group input:focus {
      outline: none;
      border-color: #667eea;
      background: rgba(15, 23, 42, 0.8);
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
    }

    .button-group {
      display: grid;
      grid-template-columns: 2fr 1fr 1fr;
      gap: 20px;
      margin-top: 40px;
    }

    .analyze-btn {
      padding: 26px;
      background: linear-gradient(135deg, #667eea 0%, #ec4899 100%);
      color: white;
      border: none;
      border-radius: 18px;
      font-size: 1.5em;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.4s ease;
      box-shadow: 0 20px 40px rgba(102, 126, 234, 0.5);
      text-transform: uppercase;
    }

    .analyze-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 25px 60px rgba(102, 126, 234, 0.7);
    }

    .reset-btn, .export-btn {
      padding: 24px;
      background: linear-gradient(135deg, #475569 0%, #334155 100%);
      color: white;
      border: none;
      border-radius: 18px;
      font-size: 1.1em;
      font-weight: 800;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
    }

    .export-btn {
      background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
    }

    .results {
      display: none;
      animation: fadeInUp 0.8s ease;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .results.show {
      display: block;
    }

    .performance-card {
      background: linear-gradient(135deg, #667eea 0%, #ec4899 50%, #8b5cf6 100%);
      color: white;
      padding: 60px;
      border-radius: 35px;
      text-align: center;
      margin-bottom: 30px;
      box-shadow: 0 40px 100px rgba(102, 126, 234, 0.6);
    }

    .performance-card h2 {
      font-size: 1.8em;
      font-weight: 800;
      margin-bottom: 25px;
    }

    .performance-score {
      font-size: 6.5em;
      font-weight: 900;
      margin: 25px 0;
    }

    .performance-rating {
      font-size: 1.8em;
      margin-top: 25px;
      font-weight: 800;
    }

    .hero-metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .hero-card {
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.95) 0%, rgba(31, 41, 55, 0.95) 100%);
      backdrop-filter: blur(30px);
      border-radius: 28px;
      padding: 45px 35px;
      text-align: center;
      box-shadow: 0 25px 70px rgba(0, 0, 0, 0.4);
      border: 2px solid rgba(102, 126, 234, 0.3);
      transition: all 0.5s ease;
    }

    .hero-card:hover {
      transform: translateY(-10px) scale(1.03);
      box-shadow: 0 40px 100px rgba(102, 126, 234, 0.5);
    }

    .hero-icon {
      font-size: 3em;
      margin-bottom: 20px;
    }

    .hero-label {
      font-size: 0.9em;
      color: #94a3b8;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 2.5px;
      margin-bottom: 20px;
    }

    .hero-value {
      font-size: 3.5em;
      font-weight: 900;
      margin: 20px 0;
      background: linear-gradient(135deg, #667eea 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .hero-subtitle {
      font-size: 0.95em;
      color: #64748b;
      font-weight: 600;
      margin-top: 15px;
    }

    .comparison-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
      gap: 30px;
      margin-bottom: 30px;
    }

    .comparison-card-premium {
      background: linear-gradient(135deg, rgba(17, 24, 39, 0.98) 0%, rgba(31, 41, 55, 0.98) 100%);
      backdrop-filter: blur(40px);
      border-radius: 30px;
      border: 2px solid rgba(102, 126, 234, 0.3);
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      transition: all 0.5s ease;
    }

    .comparison-card-premium:hover {
      transform: translateY(-12px) scale(1.02);
      box-shadow: 0 40px 120px rgba(102, 126, 234, 0.6);
    }

    .comparison-header {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(236, 72, 153, 0.15) 100%);
      padding: 30px 35px;
      display: flex;
      align-items: center;
      gap: 20px;
      border-bottom: 2px solid rgba(102, 126, 234, 0.3);
    }

    .header-icon {
      font-size: 3em;
    }

    .header-text {
      flex: 1;
    }

    .header-title {
      font-size: 1.3em;
      font-weight: 900;
      background: linear-gradient(135deg, #667eea 0%, #ec4899 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-subtitle {
      font-size: 0.85em;
      color: #94a3b8;
      font-weight: 600;
      text-transform: uppercase;
    }

    .comparison-stats {
      padding: 35px;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 25px;
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.6) 0%, rgba(30, 41, 59, 0.6) 100%);
      border-radius: 18px;
      margin-bottom: 15px;
      border-left: 4px solid rgba(102, 126, 234, 0.3);
      transition: all 0.4s ease;
    }

    .stat-row:hover {
      transform: translateX(10px);
      background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(30, 41, 59, 0.9) 100%);
    }

    .stat-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .stat-icon {
      font-size: 1.8em;
    }

    .stat-label {
      font-size: 0.95em;
      color: #cbd5e1;
      font-weight: 700;
    }

    .stat-value {
      font-size: 1.8em;
      font-weight: 900;
      color: #f1f5f9;
    }

    .alert-banner {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(220, 38, 38, 0.15) 100%);
      border: 2px solid rgba(239, 68, 68, 0.5);
      border-radius: 20px;
      padding: 25px 30px;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .alert-banner.success {
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(5, 150, 105, 0.15) 100%);
      border-color: rgba(16, 185, 129, 0.5);
    }

    .alert-banner.warning {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(217, 119, 6, 0.15) 100%);
      border-color: rgba(245, 158, 11, 0.5);
    }

    .alert-icon {
      font-size: 2.5em;
    }

    .alert-content {
      flex: 1;
    }

    .alert-title {
      font-size: 1.2em;
      font-weight: 800;
      color: #f1f5f9;
      margin-bottom: 8px;
    }

    .alert-message {
      color: #cbd5e1;
      font-size: 1em;
    }

    @media (max-width: 768px) {
      .roi-header h1 { font-size: 2.5em; }
      .input-grid { grid-template-columns: 1fr; }
      .button-group { grid-template-columns: 1fr; }
      .hero-metrics { grid-template-columns: 1fr; }
      .comparison-section { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="roi-header">
      <h1>ğŸ’ ULTIMATE ROI ANALYZER PRO 3.0</h1>
      <div class="subtitle">Advanced Marketing Analytics Dashboard</div>
    </div>

    <div class="input-section">
      <h2>ğŸ”¥ Campaign Configuration</h2>
      
      <div class="input-grid">
        <div class="input-group">
          <label>ğŸ’¸ Ad Spend (Â£)</label>
          <input type="number" id="amountSpent" value="17000" step="0.01">
        </div>
        <div class="input-group">
          <label>ğŸ¯ Total Orders</label>
          <input type="number" id="results" value="108" step="1">
        </div>
        <div class="input-group">
          <label>ğŸ“¦ Product Cost (Â£)</label>
          <input type="number" id="productCost" value="70" step="0.01">
        </div>
        <div class="input-group">
          <label>ğŸ’° Selling Price (Â£)</label>
          <input type="number" id="sellingPrice" value="120" step="0.01">
        </div>
        <div class="input-group">
          <label>âœ… Confirmation Rate (%)</label>
          <input type="number" id="confirmationRate" value="49" step="0.1" min="0" max="100">
        </div>
        <div class="input-group">
          <label>ğŸšš Delivery Rate (%)</label>
          <input type="number" id="deliveryRate" value="63" step="0.1" min="0" max="100">
        </div>
        <div class="input-group">
          <label>ğŸ“¬ Shipping (Delivered) (Â£)</label>
          <input type="number" id="shippingDelivered" value="30" step="0.01">
        </div>
        <div class="input-group">
          <label>ğŸ“­ Shipping (Failed) (Â£)</label>
          <input type="number" id="shippingFailed" value="20" step="0.01">
        </div>
        <div class="input-group">
          <label>âŒ Shipping (Cancelled) (Â£)</label>
          <input type="number" id="shippingCancelled" value="0" step="0.01">
        </div>
      </div>

      <div class="button-group">
        <button class="analyze-btn" id="analyzeBtn">ğŸš€ Analyze Campaign</button>
        <button class="export-btn" id="exportBtn">ğŸ“Š Export Data</button>
        <button class="reset-btn" id="resetBtn">ğŸ”„ Reset</button>
      </div>
    </div>

    <div class="results" id="resultsDiv">
      <div id="alertContainer"></div>

      <div class="performance-card">
        <h2>â­ Overall Performance Score</h2>
        <div class="performance-score" id="score">-</div>
        <div class="performance-rating" id="rating">Analyzing...</div>
      </div>

      <div class="hero-metrics">
        <div class="hero-card">
          <div class="hero-icon">ğŸ“Š</div>
          <div class="hero-label">ROAS</div>
          <div class="hero-value" id="heroROAS">-</div>
          <div class="hero-subtitle">Return on Ad Spend</div>
        </div>
        <div class="hero-card">
          <div class="hero-icon">ğŸ’</div>
          <div class="hero-label">ROI</div>
          <div class="hero-value" id="heroROI">-</div>
          <div class="hero-subtitle">Return on Investment</div>
        </div>
        <div class="hero-card">
          <div class="hero-icon">ğŸ’°</div>
          <div class="hero-label">CPP</div>
          <div class="hero-value" id="heroCPP">-</div>
          <div class="hero-subtitle">Cost Per Purchase</div>
        </div>
        <div class="hero-card">
          <div class="hero-icon">ğŸ“ˆ</div>
          <div class="hero-label">CPO</div>
          <div class="hero-value" id="heroCPO">-</div>
          <div class="hero-subtitle">Cost Per Order</div>
        </div>
        <div class="hero-card">
          <div class="hero-icon">ğŸ’¡</div>
          <div class="hero-label">MAX CPA</div>
          <div class="hero-value" id="heroMaxCPA">-</div>
          <div class="hero-subtitle">Maximum Profitable CPA</div>
        </div>
      </div>

      <div class="comparison-section">
        <div class="comparison-card-premium">
          <div class="comparison-header">
            <div class="header-icon">ğŸ’°</div>
            <div class="header-text">
              <div class="header-title">REVENUE BREAKDOWN</div>
              <div class="header-subtitle">Financial Performance</div>
            </div>
          </div>
          <div class="comparison-stats">
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ’µ</div>
                <div class="stat-label">Total Revenue</div>
              </div>
              <div class="stat-value" id="comp1">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸŸ¢</div>
                <div class="stat-label">Net Profit</div>
              </div>
              <div class="stat-value" id="comp2">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ’š</div>
                <div class="stat-label">Gross Profit</div>
              </div>
              <div class="stat-value" id="comp3">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ’</div>
                <div class="stat-label">Profit Margin</div>
              </div>
              <div class="stat-value" id="comp4">-</div>
            </div>
          </div>
        </div>

        <div class="comparison-card-premium">
          <div class="comparison-header">
            <div class="header-icon">ğŸ“¦</div>
            <div class="header-text">
              <div class="header-title">ORDER METRICS</div>
              <div class="header-subtitle">Conversion Pipeline</div>
            </div>
          </div>
          <div class="comparison-stats">
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">âœ…</div>
                <div class="stat-label">Confirmed Orders</div>
              </div>
              <div class="stat-value" id="comp5">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸšš</div>
                <div class="stat-label">Delivered Sales</div>
              </div>
              <div class="stat-value" id="comp6">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">âŒ</div>
                <div class="stat-label">Failed Deliveries</div>
              </div>
              <div class="stat-value" id="comp7">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸš«</div>
                <div class="stat-label">Cancelled Orders</div>
              </div>
              <div class="stat-value" id="comp8">-</div>
            </div>
          </div>
        </div>

        <div class="comparison-card-premium">
          <div class="comparison-header">
            <div class="header-icon">ğŸ’¸</div>
            <div class="header-text">
              <div class="header-title">COST ANALYSIS</div>
              <div class="header-subtitle">Investment Breakdown</div>
            </div>
          </div>
          <div class="comparison-stats">
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ“¦</div>
                <div class="stat-label">Total Product Cost</div>
              </div>
              <div class="stat-value" id="comp9">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ’¸</div>
                <div class="stat-label">Ad Spend</div>
              </div>
              <div class="stat-value" id="comp10">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸšš</div>
                <div class="stat-label">Total Shipping</div>
              </div>
              <div class="stat-value" id="comp11">-</div>
            </div>
            <div class="stat-row">
              <div class="stat-left">
                <div class="stat-icon">ğŸ’¼</div>
                <div class="stat-label">Total Investment</div>
              </div>
              <div class="stat-value" id="comp12">-</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function resetForm() {
      document.getElementById('amountSpent').value = '17000';
      document.getElementById('results').value = '108';
      document.getElementById('productCost').value = '70';
      document.getElementById('sellingPrice').value = '120';
      document.getElementById('confirmationRate').value = '49';
      document.getElementById('deliveryRate').value = '63';
      document.getElementById('shippingDelivered').value = '30';
      document.getElementById('shippingFailed').value = '20';
      document.getElementById('shippingCancelled').value = '0';
      document.getElementById('resultsDiv').classList.remove('show');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    document.getElementById('resetBtn').onclick = resetForm;

    document.getElementById('exportBtn').onclick = function() {
      if (!document.getElementById('resultsDiv').classList.contains('show')) {
        alert('Please analyze the campaign first before exporting!');
        return;
      }
      
      // Gather all data
      const inputs = {
        adSpend: parseFloat(document.getElementById('amountSpent').value) || 0,
        orders: parseFloat(document.getElementById('results').value) || 0,
        productCost: parseFloat(document.getElementById('productCost').value) || 0,
        sellingPrice: parseFloat(document.getElementById('sellingPrice').value) || 0,
        confirmationRate: parseFloat(document.getElementById('confirmationRate').value) || 0,
        deliveryRate: parseFloat(document.getElementById('deliveryRate').value) || 0,
        shippingDelivered: parseFloat(document.getElementById('shippingDelivered').value) || 0,
        shippingFailed: parseFloat(document.getElementById('shippingFailed').value) || 0,
        shippingCancelled: parseFloat(document.getElementById('shippingCancelled').value) || 0
      };

      const results = {
        roas: document.getElementById('heroROAS').textContent,
        roi: document.getElementById('heroROI').textContent,
        cpp: document.getElementById('heroCPP').textContent,
        cpo: document.getElementById('heroCPO').textContent,
        maxCPA: document.getElementById('heroMaxCPA').textContent,
        score: document.getElementById('score').textContent,
        rating: document.getElementById('rating').textContent,
        revenue: document.getElementById('comp1').textContent,
        netProfit: document.getElementById('comp2').textContent,
        grossProfit: document.getElementById('comp3').textContent,
        profitMargin: document.getElementById('comp4').textContent,
        confirmedOrders: document.getElementById('comp5').textContent,
        deliveredSales: document.getElementById('comp6').textContent,
        failedDeliveries: document.getElementById('comp7').textContent,
        cancelledOrders: document.getElementById('comp8').textContent,
        totalProductCost: document.getElementById('comp9').textContent,
        totalShipping: document.getElementById('comp11').textContent,
        totalInvestment: document.getElementById('comp12').textContent
      };

      // Create beautiful TXT report
      const line = "â•".repeat(80);
      const thinLine = "â”€".repeat(80);
      const date = new Date().toLocaleString();
      
      let report = `
${line}
                    ğŸ¯ ULTIMATE ROI ANALYZER PRO 3.0 ğŸ¯
                        Campaign Performance Report
${line}

ğŸ“… Generated: ${date}

${line}
                           ğŸ“Š EXECUTIVE SUMMARY
${line}

    â­ Performance Score:     ${results.score}/100
    ğŸ† Rating:                ${results.rating}

${thinLine}
                         ğŸ¯ KEY PERFORMANCE METRICS
${thinLine}

    ğŸ“Š ROAS (Return on Ad Spend):           ${results.roas}
    ğŸ’ ROI (Return on Investment):          ${results.roi}
    ğŸ’° Cost Per Purchase (CPP):             ${results.cpp}
    ğŸ“ˆ Cost Per Order (CPO):                ${results.cpo}
    ğŸ’¡ Maximum Profitable CPA:              ${results.maxCPA}

${line}
                          ğŸ’° REVENUE BREAKDOWN
${line}

    ğŸ’µ Total Revenue:                       ${results.revenue}
    ğŸŸ¢ Net Profit:                          ${results.netProfit}
    ğŸ’š Gross Profit:                        ${results.grossProfit}
    ğŸ’ Profit Margin:                       ${results.profitMargin}

${line}
                          ğŸ“¦ ORDER METRICS
${line}

    ğŸ¯ Total Orders:                        ${inputs.orders}
    âœ… Confirmed Orders:                    ${results.confirmedOrders}
    ğŸšš Delivered Sales:                     ${results.deliveredSales}
    âŒ Failed Deliveries:                   ${results.failedDeliveries}
    ğŸš« Cancelled Orders:                    ${results.cancelledOrders}

    ğŸ“Š Confirmation Rate:                   ${inputs.confirmationRate}%
    ğŸ“Š Delivery Rate:                       ${inputs.deliveryRate}%

${line}
                          ğŸ’¸ COST ANALYSIS
${line}

    ğŸ’¸ Ad Spend:                            Â£${inputs.adSpend.toFixed(2)}
    ğŸ“¦ Total Product Cost:                  ${results.totalProductCost}
    ğŸšš Total Shipping:                      ${results.totalShipping}
    ${thinLine}
    ğŸ’¼ TOTAL INVESTMENT:                    ${results.totalInvestment}

${line}
                         ğŸ”§ CAMPAIGN CONFIGURATION
${line}

    ğŸ’¸ Ad Spend:                            Â£${inputs.adSpend.toFixed(2)}
    ğŸ¯ Total Orders:                        ${inputs.orders}
    ğŸ“¦ Product Cost per Unit:               Â£${inputs.productCost.toFixed(2)}
    ğŸ’° Selling Price per Unit:              Â£${inputs.sellingPrice.toFixed(2)}
    âœ… Confirmation Rate:                   ${inputs.confirmationRate}%
    ğŸšš Delivery Rate:                       ${inputs.deliveryRate}%
    ğŸ“¬ Shipping Cost (Delivered):           Â£${inputs.shippingDelivered.toFixed(2)}
    ğŸ“­ Shipping Cost (Failed):              Â£${inputs.shippingFailed.toFixed(2)}
    âŒ Shipping Cost (Cancelled):           Â£${inputs.shippingCancelled.toFixed(2)}

${line}
                           ğŸ’¡ INSIGHTS & RECOMMENDATIONS
${line}

`;

      // Add insights based on performance
      const roasNum = parseFloat(results.roas);
      const roiNum = parseFloat(results.roi);
      const scoreNum = parseFloat(results.score);

      if (roiNum < 0) {
        report += `    ğŸš¨ CRITICAL: Campaign is currently losing money!\n`;
        report += `       â†’ Immediate optimization required\n`;
        report += `       â†’ Consider pausing until improvements are made\n\n`;
      } else if (roasNum < 2) {
        report += `    âš ï¸  WARNING: ROAS is below optimal levels\n`;
        report += `       â†’ Target ROAS should be above 2.0x\n`;
        report += `       â†’ Review targeting and ad creative\n\n`;
      } else if (scoreNum >= 80) {
        report += `    ğŸŒŸ EXCELLENT: Campaign performing exceptionally well!\n`;
        report += `       â†’ Consider scaling ad budget\n`;
        report += `       â†’ Maintain current optimization strategy\n\n`;
      } else if (scoreNum >= 60) {
        report += `    ğŸ‘ GOOD: Campaign showing solid performance\n`;
        report += `       â†’ Room for optimization exists\n`;
        report += `       â†’ Test new audiences and creatives\n\n`;
      } else {
        report += `    âš ï¸  NEEDS IMPROVEMENT: Campaign requires optimization\n`;
        report += `       â†’ Review all metrics carefully\n`;
        report += `       â†’ Consider A/B testing new strategies\n\n`;
      }

      report += `${line}
                         ğŸ“ˆ OPTIMIZATION TARGETS
${line}

    ğŸ¯ Recommended ROAS Target:             3.0x or higher
    ğŸ¯ Recommended ROI Target:              50%+ 
    ğŸ¯ Recommended Profit Margin:           20%+
    ğŸ’¡ Your Maximum CPA:                    ${results.maxCPA}
       (Stay below this to remain profitable)

${line}

                    Report generated by Ultimate ROI Analyzer Pro 3.0
                          Created for data-driven marketers
                               Â© ${new Date().getFullYear()}

${line}
`;

      // Download as TXT
      const blob = new Blob([report], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'ROI-Campaign-Report-' + Date.now() + '.txt';
      a.click();
      URL.revokeObjectURL(url);
    };

    document.getElementById('analyzeBtn').onclick = function() {
      var d = {
        spent: parseFloat(document.getElementById('amountSpent').value) || 0,
        results: parseFloat(document.getElementById('results').value) || 0,
        pCost: parseFloat(document.getElementById('productCost').value) || 0,
        sPrice: parseFloat(document.getElementById('sellingPrice').value) || 0,
        confRate: parseFloat(document.getElementById('confirmationRate').value) || 0,
        dRate: parseFloat(document.getElementById('deliveryRate').value) || 0,
        shipD: parseFloat(document.getElementById('shippingDelivered').value) || 0,
        shipF: parseFloat(document.getElementById('shippingFailed').value) || 0,
        shipC: parseFloat(document.getElementById('shippingCancelled').value) || 0
      };

      // Funnel calculations
      var confirmedOrders = d.results * (d.confRate / 100);
      var deliveredOrders = confirmedOrders * (d.dRate / 100);
      var failedOrders = confirmedOrders - deliveredOrders;
      var cancelledOrders = d.results - confirmedOrders;
      var overallConvRate = (deliveredOrders / d.results) * 100;
      
      // CPO and CPP calculations
      var standardCPO = d.results > 0 ? d.spent / d.results : 0;
      var realCPP = deliveredOrders > 0 ? d.spent / deliveredOrders : 0;
      
      // Revenue and costs
      var revenue = deliveredOrders * d.sPrice;
      var productCostTotal = deliveredOrders * d.pCost;
      var shippingDelivered = deliveredOrders * d.shipD;
      var shippingFailed = failedOrders * d.shipF;
      var shippingCancelled = cancelledOrders * d.shipC;
      var totalShipping = shippingDelivered + shippingFailed + shippingCancelled;
      var totalSpent = productCostTotal + d.spent + totalShipping;
      
      // Profit
      var netProfit = revenue - totalSpent;
      var grossProfit = revenue - productCostTotal - shippingDelivered;
      var netMargin = revenue > 0 ? (netProfit / revenue) * 100 : 0;
      var grossMargin = d.sPrice > 0 ? ((d.sPrice - d.pCost - d.shipD) / d.sPrice) * 100 : 0;
      
      // ROAS and ROI
      var roas = d.spent > 0 ? revenue / d.spent : 0;
      var roi = totalSpent > 0 ? ((revenue - totalSpent) / totalSpent) * 100 : 0;
      
      // Maximum Profitable CPA calculation
      var profitPerSale = d.sPrice - d.pCost - d.shipD;
      var effectiveConvRate = overallConvRate / 100;
      var maxCPA = effectiveConvRate > 0 ? profitPerSale * effectiveConvRate : 0;
      
      // Break-even calculations
      var profitPerItem = d.sPrice - d.pCost - d.shipD;
      var breakEvenROAS = profitPerItem > 0 ? d.sPrice / profitPerItem : 0;
      
      // Performance score
      var sc1 = Math.min((roas / 3.0) * 25, 25);
      var sc2 = Math.min((roi / 100) * 25, 25);
      var sc3 = Math.min((netMargin / 30.0) * 25, 25);
      var sc4 = (overallConvRate / 100) * 25;
      var score = sc1 + sc2 + sc3 + sc4;

      // Update hero metrics
      document.getElementById('heroROAS').textContent = roas.toFixed(2) + 'x';
      document.getElementById('heroROI').textContent = roi.toFixed(1) + '%';
      document.getElementById('heroCPP').textContent = 'Â£' + realCPP.toFixed(2);
      document.getElementById('heroCPO').textContent = 'Â£' + standardCPO.toFixed(2);
      document.getElementById('heroMaxCPA').textContent = 'Â£' + maxCPA.toFixed(2);

      // Update comparison cards with color coding
      document.getElementById('comp1').textContent = 'Â£' + revenue.toFixed(2);
      document.getElementById('comp1').style.color = '#10b981';
      
      document.getElementById('comp2').textContent = 'Â£' + netProfit.toFixed(2);
      document.getElementById('comp2').style.color = netProfit >= 0 ? '#10b981' : '#ef4444';
      
      document.getElementById('comp3').textContent = 'Â£' + grossProfit.toFixed(2);
      document.getElementById('comp3').style.color = '#10b981';
      
      document.getElementById('comp4').textContent = netMargin.toFixed(1) + '%';
      document.getElementById('comp4').style.color = netMargin >= 0 ? '#10b981' : '#ef4444';
      
      document.getElementById('comp5').textContent = confirmedOrders.toFixed(0);
      document.getElementById('comp5').style.color = '#3b82f6';
      
      document.getElementById('comp6').textContent = deliveredOrders.toFixed(0);
      document.getElementById('comp6').style.color = '#10b981';
      
      document.getElementById('comp7').textContent = failedOrders.toFixed(0);
      document.getElementById('comp7').style.color = '#f59e0b';
      
      document.getElementById('comp8').textContent = cancelledOrders.toFixed(0);
      document.getElementById('comp8').style.color = '#f59e0b';
      
      document.getElementById('comp9').textContent = 'Â£' + productCostTotal.toFixed(2);
      document.getElementById('comp9').style.color = '#f1f5f9';
      
      document.getElementById('comp10').textContent = 'Â£' + d.spent.toFixed(2);
      document.getElementById('comp10').style.color = '#ef4444';
      
      document.getElementById('comp11').textContent = 'Â£' + totalShipping.toFixed(2);
      document.getElementById('comp11').style.color = '#f1f5f9';
      
      document.getElementById('comp12').textContent = 'Â£' + totalSpent.toFixed(2);
      document.getElementById('comp12').style.color = '#f1f5f9';

      document.getElementById('score').textContent = score.toFixed(1);

      var rat = score >= 80 ? 'ğŸŒŸ OUTSTANDING ğŸ‰' : score >= 60 ? 'ğŸ‘ STRONG ğŸ˜Š' : score >= 40 ? 'âš ï¸ MODERATE ğŸ˜' : 'âŒ WEAK ğŸ˜';
      document.getElementById('rating').textContent = rat;

      // Alert banner
      var alertHTML = '';
      if (roi < 0) {
        alertHTML = '<div class="alert-banner"><div class="alert-icon">ğŸš¨</div><div class="alert-content"><div class="alert-title">CRITICAL: Campaign Losing Money</div><div class="alert-message">Your ROI is negative at ' + roi.toFixed(1) + '%. Immediate action required to stop losses.</div></div></div>';
      } else if (roas < breakEvenROAS) {
        alertHTML = '<div class="alert-banner warning"><div class="alert-icon">âš ï¸</div><div class="alert-content"><div class="alert-title">Warning: Below Break-Even</div><div class="alert-message">ROAS (' + roas.toFixed(2) + 'x) is below break-even (' + breakEvenROAS.toFixed(2) + 'x). Campaign needs optimization.</div></div></div>';
      } else if (roas >= 3 && roi > 50) {
        alertHTML = '<div class="alert-banner success"><div class="alert-icon">ğŸ¯</div><div class="alert-content"><div class="alert-title">Excellent Performance!</div><div class="alert-message">Campaign exceeds targets. ROAS: ' + roas.toFixed(2) + 'x | ROI: ' + roi.toFixed(1) + '%. Consider scaling.</div></div></div>';
      }
      document.getElementById('alertContainer').innerHTML = alertHTML;

      document.getElementById('resultsDiv').classList.add('show');
      setTimeout(function() {
        document.getElementById('resultsDiv').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    };
  </script>
</body>
</html>